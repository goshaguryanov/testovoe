Использовал gem'ы:
dry-validation
mutations
blueprinter
По части моделей все просто, user и operation.
Доходы и расходы пишутся все в одну таблицу.
Чтобы сделать отчет делается один SQL запрос c оконной функцией по подзапросу.
В подзапросе объединяются доходы и расходы.
В результате есть поле reminder которые указывает баланс после текущей операции.
